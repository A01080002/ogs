# Specify minimum CMake version
cmake_minimum_required(VERSION 2.8.3)

# Project name
project(OGSFileConverter)

# Source files
set(SOURCES
	FileListDialog.cpp
	OGSFileConverter.cpp
)

# Moc Header files
set(MOC_HEADERS
	FileListDialog.h
	OGSFileConverter.h
)

# UI files
set(UIS
	FileList.ui
	OGSFileConverter.ui
)

# Find installed Qt4 libraries and headers
find_package(Qt4 QUIET REQUIRED)

# Run Qts user interface compiler uic on .ui files
qt4_wrap_ui(UI_HEADERS ${UIS})

# Run Qts meta object compiler moc on header files
qt4_wrap_cpp(MOC_SOURCES ${MOC_HEADERS})

# Include the headers which are generated by uic and moc
# and include additional header
include_directories(
	${CMAKE_BINARY_DIR}/Applications/Utils/OGSFileConverter
	${CMAKE_SOURCE_DIR}/BaseLib
	${CMAKE_SOURCE_DIR}/FileIO
	${CMAKE_SOURCE_DIR}/GeoLib
	${CMAKE_SOURCE_DIR}/MeshLib
	${CMAKE_SOURCE_DIR}/Applications/DataExplorer/Base
	${CMAKE_SOURCE_DIR}/Applications/DataExplorer/DataView
	${CMAKE_SOURCE_DIR}/Applications/DataExplorer/VtkVis
)

# Put moc files in a project folder
source_group("UI Files" REGULAR_EXPRESSION "\\w*\\.ui")
source_group("Moc Files" REGULAR_EXPRESSION "moc_.*")

# Create the library
add_executable(OGSFileConverter
	main.cpp
	${SOURCES}
	${HEADERS}
	${MOC_HEADERS}
	${MOC_SOURCES}
	${UIS}
)

target_link_libraries(OGSFileConverter
	${QT_LIBRARIES}
	ApplicationsLib
	FileIO
	GeoLib
	MeshLib
	QtDataView
	VtkVis
	InSituLib
	${CATALYST_LIBRARIES}
)
ADD_CATALYST_DEPENDENCY(OGSFileConverter)

# Adds useful macros and variables
# this is needed to correctly link the qt and vtk libraries through target_link_libraries
include(${QT_USE_FILE})

# Set build configuration types
# "RelWithDebInfo" and "MinSizeRelease" can be added here
set(CMAKE_CONFIGURATION_TYPES "Release;Debug" CACHE TYPE INTERNAL FORCE)

# Set build directories
# Binaries are created in /bin and libraries in /lib
set(EXECUTABLE_OUTPUT_PATH ${CMAKE_BINARY_DIR}/bin)
set(LIBRARY_OUTPUT_PATH ${CMAKE_BINARY_DIR}/lib)

set_property(TARGET OGSFileConverter PROPERTY FOLDER "Utilities")

####################
### Installation ###
####################

install(TARGETS OGSFileConverter RUNTIME DESTINATION bin COMPONENT ogs_cli)
set(CPACK_PACKAGE_EXECUTABLES ${CPACK_PACKAGE_EXECUTABLES} "OGSFileConverter" "File Converter")
set(CPACK_NSIS_MENU_LINKS ${CPACK_NSIS_MENU_LINKS} "bin/OGSFileConverter.exe" "File Converter" PARENT_SCOPE)
